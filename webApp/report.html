<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投资组合报表</title>
    <link rel="stylesheet" href="style.css">
    <!-- Grid.js CSS -->
    <link rel="stylesheet" href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <!-- Grid.js -->
    <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>
</head>
<body>
    <!-- 登录界面 -->
    <div id="login-container" class="login-container">
        <div class="login-box">
            <h1>📊 投资组合报表系统</h1>
            <p>请使用授权Gmail账户登录</p>
            <button id="google-login" class="google-login-btn">
                <span class="google-icon">G</span>
                使用 Google 登录
            </button>
            <div id="login-message" class="message"></div>
        </div>
    </div>

    <!-- 主应用界面 -->
    <div id="app-container" class="app-container hidden">
        <!-- 顶部工具栏 -->
        <header class="header">
            <div class="header-left">
                <div class="logo">📊 投资组合报表</div>
            </div>
            <div class="header-right">
                <span id="user-info" class="user-info"></span>
                <button id="logout-btn" class="logout-btn">登出</button>
            </div>
        </header>

        <div class="main-container">
            <!-- 左侧导航 -->
            <nav class="sidebar">
                <ul class="nav-menu">
                    <li class="nav-item" data-section="holdings-report">
                        <span class="nav-icon">📈</span>
                        <span class="nav-text">持仓报表</span>
                    </li>
                    <li class="nav-item" data-section="performance">
                        <span class="nav-icon">📊</span>
                        <span class="nav-text">业绩分析</span>
                    </li>
                    <li class="nav-item" data-section="export">
                        <span class="nav-icon">💾</span>
                        <span class="nav-text">数据导出</span>
                    </li>
                </ul>
            </nav>

            <!-- 右侧内容区 -->
            <main class="content">
                <!-- 持仓报表部分 -->
                <section id="holdings-report-section" class="content-section active">
                    <div class="section-header">
                        <h2>📈 持仓报表</h2>
                        <div class="section-actions">
                            <button id="refresh-report" class="btn btn-primary">🔄 刷新数据</button>
                            <button id="export-csv" class="btn btn-success">📥 导出CSV</button>
                        </div>
                    </div>
                    
                    <!-- 筛选控件 -->
                    <div class="filter-controls">
                        <div class="form-group">
                            <label for="currency-filter">货币筛选:</label>
                            <select id="currency-filter" class="form-select">
                                <option value="">所有货币</option>
                                <option value="CNY">人民币</option>
                                <option value="HKD">港币</option>
                                <option value="USD">美元</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pl-filter">盈亏筛选:</label>
                            <select id="pl-filter" class="form-select">
                                <option value="">所有持仓</option>
                                <option value="profit">盈利</option>
                                <option value="loss">亏损</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="search-input">搜索:</label>
                            <input type="text" id="search-input" class="form-input" placeholder="搜索股票代码或公司名称...">
                        </div>
                    </div>

                    <!-- Grid.js 表格容器 -->
                    <div id="report-table-container" class="table-container">
                        <div id="report-grid-wrapper"></div>
                    </div>

                    <!-- 统计摘要 -->
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="card-title">总持仓数量</div>
                            <div class="card-value" id="total-holdings">0</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-title">总成本 (CNY)</div>
                            <div class="card-value" id="total-cost">0</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-title">总市值 (CNY)</div>
                            <div class="card-value" id="total-value">0</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-title">总盈亏</div>
                            <div class="card-value" id="total-pl">0</div>
                        </div>
                    </div>
                </section>

                <!-- 业绩分析部分 -->
                <section id="performance-section" class="content-section">
                    <div class="section-header">
                        <h2>📊 业绩分析</h2>
                    </div>
                    <div id="performance-content">
                        <p>业绩分析功能开发中...</p>
                    </div>
                </section>

                <!-- 数据导出部分 -->
                <section id="export-section" class="content-section">
                    <div class="section-header">
                        <h2>💾 数据导出</h2>
                    </div>
                    <div id="export-content">
                        <div class="export-options">
                            <div class="form-group">
                                <label>导出格式:</label>
                                <select id="export-format" class="form-select">
                                    <option value="csv">CSV</option>
                                    <option value="json">JSON</option>
                                    <option value="excel">Excel</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>数据范围:</label>
                                <select id="export-range" class="form-select">
                                    <option value="current">当前视图数据</option>
                                    <option value="all">全部数据</option>
                                </select>
                            </div>
                            <button id="start-export" class="btn btn-primary">开始导出</button>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="auth-config.js"></script>
    <script src="report-app.js"></script>
</body>
</html>